/** sgml-stream is MIT licensed, see /LICENSE. */
namespace HTL\SGMLStream\Tests;

use namespace HTL\TestChain;
use function HTL\Expect\expect;

<<TestChain\Discover>>
function given_a_spread_of_declared_set_attribute_to_a_tag_with_the_same_attribute_specified_as_null_in_the_xhp_open_test(
  TestChain\Chain $chain,
)[]: TestChain\Chain {
  return $chain->group(__FUNCTION__)
    ->test('test_the_explicit_null_value_is_overridden_by_the_spread', ()[
      defaults,
    ] ==> {
      $type_under_test =
        <herp_and_derp herp={null} {...<herp_and_derp herp="from-spread" />} />;
      expect(get_attributes($type_under_test))->toEqual(
        tuple(dict['herp' => 'from-spread'], dict[]),
      );
    })
    ->test(
      'test_the_explicit_null_value_passed_after_the_spread_overrides_the_value_from_the_spread',
      () ==> {
        $type_under_test =
          <herp_and_derp
            {...<herp_and_derp herp="from-spread" />}
            herp={null}
          />;
        expect($type_under_test->:herp)->toEqual(null);
      },
    );
}
